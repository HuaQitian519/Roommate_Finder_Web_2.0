{% extends 'base.html' %}
{% block title %}注册 - 室友匹配系统{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8 col-lg-7">
    <div class="card p-4">
      <h2 class="mb-4 text-center">注册新用户</h2>
      <form method="post">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">真实姓名</label>
            <input type="text" class="form-control" name="real_name" value="{{ form_data.real_name if form_data else '' }}" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">用户名</label>
            <input type="text" class="form-control" name="username" value="{{ form_data.username if form_data else '' }}" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">性别</label>
            <select class="form-select" name="gender" required>
              <option value="">请选择</option>
              <option value="男" {% if form_data and form_data.gender == '男' %}selected{% endif %}>男</option>
              <option value="女" {% if form_data and form_data.gender == '女' %}selected{% endif %}>女</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">专业</label>
            <select class="form-select" name="major" required>
              <option value="">请选择专业</option>
              <option value="数字媒体技术" {% if form_data and form_data.major == '数字媒体技术' %}selected{% endif %}>数字媒体技术</option>
              <option value="智能科学与技术" {% if form_data and form_data.major == '智能科学与技术' %}selected{% endif %}>智能科学与技术</option>
              <option value="视觉传达设计" {% if form_data and form_data.major == '视觉传达设计' %}selected{% endif %}>视觉传达设计</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">作息时间</label>
            <div class="input-group">
              <span class="input-group-text">睡觉</span>
              <input type="time" class="form-control" name="sleep_time" value="{{ form_data.sleep_time if form_data else '23:30' }}" required>
              <span class="input-group-text">起床</span>
              <input type="time" class="form-control" name="wake_time" value="{{ form_data.wake_time if form_data else '07:30' }}" required>
            </div>
          </div>
          <div class="col-md-6">
            <label class="form-label">空调温度（℃）</label>
            <input type="range" class="form-range" min="16" max="30" step="1" name="ac_temp" id="ac_temp_range" value="{{ form_data.ac_temp if form_data else '24' }}" oninput="ac_temp_value.value = ac_temp_range.value">
            <output id="ac_temp_value" class="ms-2">{{ form_data.ac_temp if form_data else '24' }}</output>
          </div>
          <div class="col-md-6">
            <label class="form-label">卫生习惯</label>
            <select class="form-select" name="cleanliness" required>
              <option value="">请选择</option>
              <option value="1" {% if form_data and form_data.cleanliness == '1' %}selected{% endif %}>1 - 比较随意</option>
              <option value="2" {% if form_data and form_data.cleanliness == '2' %}selected{% endif %}>2</option>
              <option value="3" {% if form_data and form_data.cleanliness == '3' %}selected{% endif %}>3 - 一般</option>
              <option value="4" {% if form_data and form_data.cleanliness == '4' %}selected{% endif %}>4</option>
              <option value="5" {% if form_data and form_data.cleanliness == '5' %}selected{% endif %}>5 - 非常爱干净</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">床铺偏好</label>
            <select class="form-select" name="bunk_preference" required>
              <option value="">请选择</option>
              <option value="上铺" {% if form_data and form_data.bunk_preference == '上铺' %}selected{% endif %}>上铺</option>
              <option value="下铺" {% if form_data and form_data.bunk_preference == '下铺' %}selected{% endif %}>下铺</option>
              <option value="无" {% if form_data and form_data.bunk_preference == '无' %}selected{% endif %}>无特别偏好</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">学习习惯</label>
            <select class="form-select" name="study_habits" required>
              <option value="">请选择</option>
              <option value="寝室学习" {% if form_data and form_data.study_habits == '寝室学习' %}selected{% endif %}>寝室学习</option>
              <option value="图书馆学习" {% if form_data and form_data.study_habits == '图书馆学习' %}selected{% endif %}>图书馆学习</option>
              <option value="自习室学习" {% if form_data and form_data.study_habits == '自习室学习' %}selected{% endif %}>自习室学习</option>
              <option value="无" {% if form_data and form_data.study_habits == '无' %}selected{% endif %}>无特别偏好</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">周末留校</label>
            <select class="form-select" name="weekend_stay" required>
              <option value="">请选择</option>
              <option value="经常" {% if form_data and form_data.weekend_stay == '经常' %}selected{% endif %}>经常</option>
              <option value="偶尔" {% if form_data and form_data.weekend_stay == '偶尔' %}selected{% endif %}>偶尔</option>
              <option value="从不" {% if form_data and form_data.weekend_stay == '从不' %}selected{% endif %}>从不</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">集体生活</label>
            <select class="form-select" name="group_life" required>
              <option value="">请选择</option>
              <option value="喜欢" {% if form_data and form_data.group_life == '喜欢' %}selected{% endif %}>喜欢</option>
              <option value="一般" {% if form_data and form_data.group_life == '一般' %}selected{% endif %}>一般</option>
              <option value="不喜欢" {% if form_data and form_data.group_life == '不喜欢' %}selected{% endif %}>不喜欢</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">MBTI（可选）</label>
            <input type="text" class="form-control" name="mbti" maxlength="16" placeholder="如：INFP、ESTJ等" value="{{ form_data.mbti if form_data else '' }}">
          </div>
          <div class="col-md-12">
            <label class="form-label">爱好（可多项，用逗号分隔）</label>
            <input type="text" class="form-control" name="hobbies" placeholder="如：篮球, 音乐, 阅读" value="{{ form_data.hobbies if form_data else '' }}">
          </div>
          <div class="col-md-12">
            <label class="form-label">对室友要求（可选）</label>
            <textarea class="form-control" name="roommate_preferences" placeholder="如：希望室友安静、爱干净等">{{ form_data.roommate_preferences if form_data else '' }}</textarea>
          </div>
          <div class="col-md-12">
            <label class="form-label">饮食禁忌</label>
            <input type="text" class="form-control" name="dietary_restrictions" placeholder="如：无、或填写具体内容" value="{{ form_data.dietary_restrictions if form_data else '' }}">
          </div>
          <div class="col-md-12">
            <label class="form-label">微信号</label>
            <input type="text" class="form-control" name="wechat" required value="{{ form_data.wechat if form_data else '' }}">
          </div>
          <div class="col-md-12">
            <label class="form-label">密码</label>
            <input type="password" class="form-control" name="password" required>
          </div>
          <div class="col-md-12">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="agree_terms" id="agree_terms" required>
              <label class="form-check-label" for="agree_terms">
                我已阅读并同意 <a href="/agreement" target="_blank" class="text-primary">《用户使用协议》</a>
              </label>
            </div>
          </div>
        </div>
        <div class="d-grid mt-4">
          <button type="submit" class="btn btn-primary btn-lg">注册</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script>
// 实时显示空调温度滑块的值
const ac_temp_range = document.getElementById('ac_temp_range');
const ac_temp_value = document.getElementById('ac_temp_value');
if(ac_temp_range && ac_temp_value) {
  ac_temp_range.addEventListener('input', function() {
    ac_temp_value.value = ac_temp_range.value;
  });
}
</script>
{% endblock %}
