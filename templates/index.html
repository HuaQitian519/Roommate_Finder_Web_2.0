{% extends 'base.html' %}
{% block title %}é¦–é¡µ - å®¤å‹åŒ¹é…ç³»ç»Ÿ2.0{% endblock %}
{% block content %}
<style>
.card-gradient-bar {
  height: 4px;
  border-top-left-radius: 1rem;
  border-top-right-radius: 1rem;
  background: linear-gradient(90deg, #b3c6e6 0%, #ffe0b3 50%, #b3e6e6 100%);
}
.card-user {
  transition: box-shadow 0.2s;
  box-shadow: 0 2px 12px rgba(79,140,255,0.07);
  border-radius: 1rem;
}
.card-user:hover {
  box-shadow: 0 6px 24px rgba(79,140,255,0.18);
  transform: translateY(-2px) scale(1.02);
}
.badge-major { background: #b3c6e6; color: #222; font-weight: 500; }
.badge-hobby { background: #e6b3e6; color: #222; font-weight: 500; }
.text-label { color: #888; font-size: 0.98em; margin-right: 0.5em; }
.text-main { color: #222; font-weight: 500; }
.text-wechat { color: #1a7f37; font-weight: 600; font-size: 1.1em; }
form.button-form { display: inline; padding: 0; margin: 0; border: 0; background: transparent; }
.welcome-card {
  background: linear-gradient(135deg, #e6ecf5 0%, #f5e6ec 100%);
  color: #333;
  border-radius: 1rem;
  padding: 2rem;
  margin-bottom: 2rem;
  box-shadow: 0 2px 12px rgba(0,0,0,0.04);
}
.action-buttons {
  display: flex;
  gap: 1rem;
  justify-content: center;
  flex-wrap: wrap;
}
.action-buttons .btn {
  background: #e6ecf5;
  color: #333;
  border: 1px solid #b3c6e6;
  font-weight: 500;
  border-radius: 0.5rem;
  box-shadow: none;
  transition: background 0.2s, color 0.2s;
}
.action-buttons .btn:hover {
  background: #d1dbe8;
  color: #222;
}
@media (max-width: 768px) {
  .action-buttons {
    flex-direction: column;
  }
  .action-buttons .btn {
    width: 100%;
    margin: 5px 0;
  }
}
</style>

{% if not current_user.is_authenticated %}
<div class="welcome-card text-center">
  <h2 class="mb-3">ğŸ“ æ¬¢è¿æ¥åˆ°å®¤å‹åŒ¹é…ç³»ç»Ÿ</h2>
  <p class="mb-4">æ‰¾åˆ°æœ€é€‚åˆä½ çš„å®¤å‹ï¼Œå¼€å¯ç¾å¥½çš„å¤§å­¦ç”Ÿæ´»ï¼</p>
  <div class="action-buttons">
    <a href="/register" class="btn btn-lg px-5">
      ç«‹å³æ³¨å†Œ
    </a>
    <a href="/login" class="btn btn-lg px-5">
      ç”¨æˆ·ç™»å½•
    </a>
  </div>
</div>
{% endif %}

<div class="text-center mb-4">
  <h2>æ¬¢è¿ï¼Œ{{ current_user.username if current_user.is_authenticated else 'åŒå­¦' }}!</h2>
</div>

  <div class="mb-4">
    <p>æ­¤å¹³å°ç”±INNOåŒå­¦å¼€å‘ï¼Œå¦‚æœ‰ç–‘é—®ï¼Œå¯ä»¥åŠ å¾®ä¿¡INNO-ONNIè¿›è¡Œå’¨è¯¢</p>
    <p>æ³¨æ„âš ï¸æ‰€æœ‰åŒå­¦ä¿¡æ¯å‡éœ€é€šè¿‡äººå·¥å®¡æ ¸æ‰ä¼šæ˜¾ç¤ºï¼Œä½†å¹³å°æ— æ³•100%ä¿è¯ä¿¡æ¯çš„çœŸå®æ€§ï¼Œè¯·åŒå­¦ä»¬ä»”ç»†åˆ†è¾¨ï¼Œå¼‚å¸¸æƒ…å†µç§¯æä¸¾æŠ¥</p>
    <p>æ³¨æ„âš ï¸å•ä¸ªIPåªèƒ½æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œè¯·è®¤çœŸå¡«å†™ä½ è‡ªå·±çš„ä¿¡æ¯</p>
    <p>æ³¨æ„âš ï¸æ¯ä¸ªè´¦å·24hå†…åªèƒ½ä¿®æ”¹ä¸€æ¬¡ä¿¡æ¯ï¼Œè¯·åŒå­¦ä»¬è°¨æ…ä¿®æ”¹ä¿¡æ¯</p>
    <p class="text-muted">ä½¿ç”¨æœ¬ç³»ç»Ÿå³è¡¨ç¤ºæ‚¨åŒæ„æˆ‘ä»¬çš„ <a href="/agreement" class="text-primary">ã€Šç”¨æˆ·ä½¿ç”¨åè®®ã€‹</a></p>
    <h4 class="fw-bold mt-4 mb-3">ç›®å‰è¯¥å¹³å°å¤„äºbetaæµ‹è¯•é˜¶æ®µï¼Œå¯èƒ½æœ‰å„ç§BUGæˆ–è€…æ„å¤–å‡ºç°ï¼ŒåŒ¹é…ç®—æ³•ä¹Ÿå°†æŒç»­ä¼˜åŒ–ï¼Œæ¬¢è¿åŒå­¦ä»¬åŠæ—¶åé¦ˆ</h4>
  </div>

{% if current_user.is_authenticated %}
  <div class="d-flex justify-content-center align-items-center gap-4 mb-4 flex-wrap">
    <form method="post" action="/toggle_roommate_status" class="button-form">
      <button type="submit" class="btn btn-success btn-lg px-5">{{ 'æˆ‘å·²æ‰¾åˆ°å®¤å‹' if not current_user.has_found_roommate else 'å–æ¶ˆå·²æ‰¾åˆ°å®¤å‹' }}</button>
    </form>
    <a href="/match" class="btn btn-primary btn-lg px-5" style="font-weight:600;box-shadow:0 2px 8px rgba(79,140,255,0.12);">ğŸ” æ™ºèƒ½åŒ¹é…</a>
  </div>

  <div class="card p-3 mb-4">
    <h5 class="mb-3">ã€éšæœºåŒ¹é…ã€‘çœ‹çœ‹è¿™äº›åŒå­¦æ˜¯å¦ä¸ä½ ç”Ÿæ´»ä¹ æƒ¯ç›¸è¿‘ï¼Œæˆ–ç‚¹å‡»å³ä¸Šè§’"æ™ºèƒ½åŒ¹é…"ç²¾å‡†åŒ¹é…ï¼š</h5>
    <div class="row g-4 justify-content-center">
      {% for user in random_users %}
        <div class="col-md-6 col-lg-4">
          <div class="card card-user shadow-sm h-100">
            <div class="card-gradient-bar"></div>
            <div class="card-body">
              <h5 class="card-title mb-2 text-main">{{ user.real_name }}</h5>
              <div class="mb-2"><span class="badge badge-major me-2">ä¸“ä¸š</span>{{ user.major }}</div>
              {% if user.mbti %}
              <div class="mb-2"><span class="badge bg-info text-dark me-2">MBTI</span>{{ user.mbti }}</div>
              {% endif %}
              <div class="mb-2"><span class="text-label">ä½œæ¯</span>{{ user.sleep_time }} - {{ user.wake_time }}</div>
              <div class="mb-2"><span class="text-label">åºŠé“º</span>{% if user.bunk_preference in ['ä¸Šé“º','upper'] %}ä¸Šé“º{% elif user.bunk_preference in ['ä¸‹é“º','lower'] %}ä¸‹é“º{% else %}æ— åå¥½{% endif %}</div>
              <div class="mb-2"><span class="text-label">å«ç”Ÿ</span>{% if user.cleanliness|int >= 5 %}éå¸¸çˆ±å¹²å‡€{% elif user.cleanliness|int >= 3 %}ä¸€èˆ¬{% else %}æ¯”è¾ƒéšæ„{% endif %}ï¼ˆ{{ user.cleanliness }}ï¼‰</div>
              <div class="mb-2"><span class="text-label">å­¦ä¹ </span>{% if user.study_habits %}{{ user.study_habits }}{% else %}æ— ç‰¹åˆ«åå¥½{% endif %}</div>
              <div class="mb-2"><span class="text-label">å‘¨æœ«ç•™æ ¡</span>{{ user.weekend_stay }}</div>
              <div class="mb-2"><span class="text-label">é›†ä½“ç”Ÿæ´»</span>{{ user.group_life }}</div>
              <div class="mb-2"><span class="badge badge-hobby me-2">çˆ±å¥½</span>{{ user.hobbies }}</div>
              <div class="mb-2"><span class="text-label">é¥®é£Ÿç¦å¿Œ</span>{{ user.dietary_restrictions }}</div>
              <div class="mb-2"><span class="text-label">å¾®ä¿¡</span>
                <span class="text-wechat" id="wechat-index-{{ loop.index }}">{{ user.wechat }}</span>
                <button class="btn btn-outline-secondary btn-sm ms-2" type="button" onclick="navigator.clipboard.writeText('{{ user.wechat }}')">å¤åˆ¶</button>
              </div>
            </div>
          </div>
        </div>
      {% else %}
        <div class="col-12 text-center text-muted">æš‚æ— å¯å±•ç¤ºçš„åŒå­¦</div>
      {% endfor %}
    </div>
  </div>
{% endif %}
{% endblock %}